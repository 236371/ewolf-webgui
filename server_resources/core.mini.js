var AppContainer=function(e,a){var c=false;var b=true;var d=$("<div/>").attr({id:e+"ApplicationFrame"}).hide().appendTo(a);eWolf.bind("select."+e,function(g,f){if(e==f){d.slideDown(700);c=true;if(b){eWolf.trigger("refresh."+e,[e])}}else{d.slideUp(700);c=false}});eWolf.bind("refresh."+e,function(g,f){if(e==f){b=false}});eWolf.bind("needRefresh."+e,function(g,f){b=true;if(c){eWolf.trigger("refresh."+e,[e])}});return{getFrame:function(){return d},getId:function(){return e},isSelected:function(){return c},destroy:function(){eWolf.unbind("select."+e);d.remove();delete this}}};function Application(e,a,d,b,c){this.id=e;this.container=a;this.menu=d;this.menuList=b;this.loadingFrame=c;this.loader=null;this.loading=false;this.frame=$("<div/>").attr({id:this.id+"ApplicationFrame"}).hide().data("applicationItem",this).appendTo(this.container);return this}Application.prototype.appendLoader=function(a){this.loader=a};Application.prototype.isNeedRefresh=function(){return this.frame.is(":empty")};Application.prototype.isLoading=function(){return this.loading};Application.prototype.appear=function(){this.container.children("div").slideUp(700);this.frame.slideDown(700)};Application.prototype.setLoading=function(){this.loading=true;if(this.loader!=null){this.loader.showLoading()}};Application.prototype.clearLoading=function(){if(this.loader!=null){this.loader.hideLoading()}this.loading=false};Application.prototype.refresh=function(){};var Flicker=function(c,a){var e=new AppContainer(c,a);var f=e.getFrame();var h=e.getId();var d=new Date(0);var g=null;function b(m,l,i,k){var n=$("<a/>").attr({href:i,target:"_TRG_"+m});$("<img/>").attr({src:l,style:"padding:5px 5px 5px 5px; height:130px;"}).appendTo(n);if(k==null){f.prepend(n)}else{k.after(n)}var j=$("<em/>").append("&nbsp;");n.after(j);return j}eWolf.bind("refresh."+h,function(j,i){clearTimeout(g);eWolf.trigger("loading",[h]);$.getJSON("http://api.flickr.com/services/feeds/photos_public.gne?jsoncallback=?",{tags:h,tagmode:"any",format:"json"},function(m){console.log(m);var l=d;var k=null;$.each(m.items,function(o,p){var n=new Date(p.published);if(n-d>0){k=b(p.title,p.media.m,p.link,k);if(n-l>0){l=n}}});d=l;eWolf.trigger("loadingEnd",[h]);g=setTimeout("eWolf.trigger('needRefresh."+h+"',["+h+"])",60000)})});return{getId:function(){return h},isSelected:function(){return e.isSelected()},destroy:function(){eWolf.unbind("refresh."+h);eWolf.unbind("select."+h);e.destroy();delete this}}};var Loading=function(b){var d=0;function a(){d++;b.spin(spinnerOpts);b.show(200)}function c(){b.hide(200);b.data("spinner").stop();d--}eWolf.bind("loading",a);eWolf.bind("loadingEnd",c);return{listenToEvent:function(f,e){eWolf.bind(f,a);eWolf.bind(e,c)},stopListenToEvent:function(f,e){eWolf.unbind(f,a);eWolf.unbind(e,c)}}};var spinnerOpts={lines:10,length:4,width:2,radius:3,rotate:0,color:"#fff",speed:0.8,trail:60,shadow:false,hwaccel:false,className:"spinner",zIndex:2000000000,top:0,left:0};$.fn.spin=function(a){this.each(function(){var c=$(this),b=c.data();if(b.spinner){b.spinner.stop();delete b.spinner}if(a!==false){b.spinner=new Spinner($.extend({color:c.css("color")},a)).spin(this)}});return this};var MainApps=function(g,b){var d=g.createNewMenuList("mainapps","Main");var f=[];var a=new Flicker("wall",b);d.addMenuItem("wall","My Wall");f.push(a);var e=new Flicker("news_feed",b);d.addMenuItem("news_feed","News Feed");f.push(e);var c=new Flicker("messages",b);d.addMenuItem("messages","Messages");f.push(c);return this};var MenuItem=function(c,n,l,j){var h=false;var g=false;var p=new MenuMessage(c+"Message","menuItemMessageClass",l,j);var a=$("<li/>").attr({id:c});var d=$("<a/>").appendTo(a);var i=$("<span/>").attr({id:c,style:"width:1%;"}).append(n).appendTo(d);var e=$("<div/>").attr({"class":"refreshButtonArea",id:c,}).appendTo(d).hide();var b=$("<div/>").attr({"class":"refreshButtonArea",id:c,}).appendTo(d).hide();var k=$("<img/>").attr({id:c,src:"refresh.svg","class":"refreshButton"}).appendTo(e);a.click(function(){if(g==false){eWolf.trigger("select",[c])}});k.click(function(){if(h==false){eWolf.trigger("refresh."+c,[c])}});a.mouseover(function(){p.show()});a.mouseout(function(){p.hide()});function o(){var q=145;if(g&&!h){e.show();q=q-20}else{e.hide()}if(h){b.show();q=q-20}else{b.hide()}i.text(n).shorten({width:q})}function m(){d.addClass("currentMenuSelection");g=true;o()}function f(){d.removeClass("currentMenuSelection");g=false;o()}eWolf.bind("select."+c,function(r,q){if(c==q){m()}else{f()}});eWolf.bind("loading."+c,function(r,q){if(c==q){h=true;o();b.spin(menuItemSpinnerOpts)}});eWolf.bind("loadingEnd."+c,function(r,q){if(c==q){h=false;o();b.data("spinner").stop()}});return{appendTo:function(q){a.appendTo(q);i.shorten({width:140});return this},getId:function(){return c},destroy:function(){p.destroy();a.remove();delete this}};return this};var menuItemSpinnerOpts={lines:10,length:4,width:2,radius:3,rotate:0,color:"#000",speed:0.8,trail:60,shadow:false,hwaccel:false,className:"spinner",zIndex:2000000000,top:0,left:0};var MenuList=function(f,g,e,a){var b=[];var d=$("<div/>").attr({"class":"menuList",id:g+"Frame"}).hide();$("<div/>").attr({"class":"menuListTitle",id:g+"Title"}).append(e).appendTo(d);var c=$("<ul/>").attr({id:g}).appendTo(d);return{addMenuItem:function(j,i){var h=new MenuItem(j,i,"Click to "+i.toLowerCase(),a).appendTo(c);b[j]=h;if(Object.keys(b).length>0){d.show()}},removeMenuItem:function(h){if(b[h]!=null){b[h].destroy();delete b[h]}if(Object.keys(b).length<=0){d.hide()}},appendTo:function(h){d.appendTo(h);return this}}};var MenuMessage=function(e,b,d,a){var c=null;return{show:function(){if(c==null){c=$("<div/>").attr({id:e,"class":b}).text(d).appendTo(a)}else{c.show()}},hide:function(){if(c!=null){c.remove();c=null}},destroy:function(){if(c!=null){c.remove();c=null;delete this}}}};var SearchApp=function(b,c,e,j,h,d){var k=c.createNewMenuList("search","Searches");var a=new Object();var i=null;function g(m,o){var n=new Flicker(m,e);a[m]=n;k.addMenuItem(m,o)}function l(m){if(a[m]!=null){a[m].destroy();delete a[m];k.removeMenuItem(m)}}function f(){if(i!=null){l(i);i=null}}d.click(function(){var m=j.val();if(m!=""){g(m,"Show "+m);eWolf.trigger("select",[m])}});h.click(function(){var m=j.val();if(m!=""){f();i=m;g(m,"Last: "+m);eWolf.trigger("select",[m])}});eWolf.bind("select."+b,function(n,m){if(m!=i){f()}});j.keyup(function(m){if(m.keyCode==13&&j.val()!=""){if(m.shiftKey){d.click()}else{h.click()}}if(j.val()==""){h.hide(200);d.hide(200)}else{h.show(200);d.show(200)}});return this};var SideMenu=function(a,e,i){a.data("menuObj",this);e.data("menuObj",this);var h=a.children("#toggleButtons");var n=h.children("#btnHideMenu").data("menuObj",this).click(function(){m()}),j=h.children("#btnShowMenu").data("menuObj",this).click(function(){p()}),k=h.children("#btnPin").data("menuObj",this).click(function(){o()}),d=h.children("#btnUnPin").data("menuObj",this).click(function(){l()}),c=[];function p(){j.hide();b();q();n.show()}function m(){n.hide();g();f();j.show()}function o(){q();k.hide();d.show();n.show();a.unbind("mouseover");a.unbind("mouseout")}function l(){f();d.hide();k.show();n.hide();a.mouseover(function(){b()});a.mouseout(function(){g()})}function g(){a.stop();a.animate({opacity:0.25,left:"-175px",},200,function(){})}function b(){a.stop();a.animate({opacity:0.7,left:"-35px",},200,function(){})}function f(){e.stop();e.animate({left:"30px",right:"0"},200,function(){})}function q(){e.stop();e.animate({left:"170px",right:"0"},200,function(){})}return{append:function(r){a.append(r)},createNewMenuList:function(t,s){var r=new MenuList(this,t,s,i).appendTo(a);c.push(r);return r}}};var Wolfpacks=function(e,b){var d=e.createNewMenuList("wolfpacks","Wolfpacks");var f=[];c();function a(g,i){var h=new Flicker(g,b);d.addMenuItem(g,i);f.push(h)}
/*!
	 * Load menu from eWolf server.
	 * Will be used to load wolfpacks of the user.
	 */
function c(){$.getJSON("/json?callBack=?",{tags:"wolfpacks",tagmode:"any",format:"json"},function(g){$.each(g,function(h,j){a(j.key,j.title)})})}return this};var eWolfMaster=new function(){};var eWolf=$(eWolfMaster);(function(f){var k=false,l,a,e,m="shorten-info",d="shorten-options";f.fn.shorten=function(){var q={},o=arguments,p=o.callee;if(o.length){if(o[0].constructor==Object){q=o[0]}else{if(o[0]=="options"){return f(this).eq(0).data(d)}else{q={width:parseInt(o[0]),tail:o[1]}}}}this.css("visibility","hidden");var n=f.extend({},p.defaults,q);return this.each(function(){var y=f(this),E=y.text(),z=E.length,A,B=f("<span/>").html(n.tail).text(),x,s={shortened:false,textOverflow:false};if(y.css("float")!="none"){A=n.width||y.width()}else{A=n.width||y.parent().width()}if(A<0){return true}y.data(d,n);this.style.whiteSpace="nowrap";if(l){a=g.call(this);e=j}else{a=b.call(this);e=i}var t=e.call(this,E,a);if(t<A){y.text(E);this.style.visibility="visible";y.data(m,s);return true}if(n.tooltip){this.setAttribute("title",E)}if(p._native&&!q.width){var r=f("<span>"+n.tail+"</span>").text();if(r.length==1&&r.charCodeAt(0)==8230){y.text(E);this.style.overflow="hidden";this.style[p._native]="ellipsis";this.style.visibility="visible";s.shortened=true;s.textOverflow="ellipsis";y.data(m,s);return true}}x=e.call(this,B,a);A=A-x;var D=A*1.15;if(t-D>0){var u=D/t,w=Math.ceil(z*u),C=E.substring(0,w),v=e.call(this,C,a);if(v>A){E=C;z=E.length}}do{z--;E=E.substring(0,z)}while(e.call(this,E,a)>=A);y.html(f.trim(f("<span/>").text(E).html())+n.tail);this.style.visibility="visible";s.shortened=true;y.data(m,s);return true});return true};var h=document.documentElement.style;if("textOverflow" in h){k="textOverflow"}else{if("OTextOverflow" in h){k="OTextOverflow"}}if(typeof Modernizr!="undefined"&&Modernizr.canvastext){l=Modernizr.canvastext}else{var c=document.createElement("canvas");l=!!(c.getContext&&c.getContext("2d")&&(typeof c.getContext("2d").fillText==="function"))}f.fn.shorten._is_canvasTextSupported=l;f.fn.shorten._native=k;function g(){var o=f(this);var n=document.createElement("canvas");ctx=n.getContext("2d");o.html(n);ctx.font=o.css("font-style")+" "+o.css("font-variant")+" "+o.css("font-weight")+" "+Math.ceil(parseFloat(o.css("font-size")))+"px "+o.css("font-family");return ctx}function j(o,n){return n.measureText(o).width}function b(){var o="padding:0; margin:0; border:none; font:inherit;";var n=f('<table style="'+o+'width:auto;zoom:1;position:absolute;"><tr style="'+o+'"><td style="'+o+'white-space:nowrap;"></td></tr></table>');$td=f("td",n);f(this).html(n);return $td}function i(o,n){n.text(o);return n.width()}f.fn.shorten.defaults={tail:"&hellip;",tooltip:true}})(jQuery);(function(H,G,F){function B(b,h){var g=G.createElement(b||"div"),f;for(f in h){g[f]=h[f]}return g}function A(e){for(var d=1,f=arguments.length;d<f;d++){e.appendChild(arguments[d])}return e}function y(I,q,p,o){var n=["opacity",q,~~(I*100),p,o].join("-"),m=0.01+p/o*100,i=Math.max(1-(1-I)/q*(100-m),I),f=C.substring(0,C.indexOf("Animation")).toLowerCase(),e=f&&"-"+f+"-"||"";return D[n]||(z.insertRule("@"+e+"keyframes "+n+"{0%{opacity:"+i+"}"+m+"%{opacity:"+I+"}"+(m+0.01)+"%{opacity:1}"+(m+q)%100+"%{opacity:"+I+"}100%{opacity:"+i+"}}",0),D[n]=1),n}function x(d,c){var j=d.style,i,h;if(j[c]!==F){return c}c=c.charAt(0).toUpperCase()+c.slice(1);for(h=0;h<E.length;h++){i=E[h]+c;if(j[i]!==F){return i}}}function w(e,d){for(var f in d){e.style[x(e,f)||f]=d[f]}return e}function v(f){for(var c=1;c<arguments.length;c++){var h=arguments[c];for(var g in h){f[g]===F&&(f[g]=h[g])}}return f}function u(d){var c={x:d.offsetLeft,y:d.offsetTop};while(d=d.offsetParent){c.x+=d.offsetLeft,c.y+=d.offsetTop}return c}var E=["webkit","Moz","ms","O"],D={},C,z=function(){var b=B("style");return A(G.getElementsByTagName("head")[0],b),b.sheet||b.styleSheet}(),t={lines:12,length:7,width:5,radius:10,rotate:0,color:"#000",speed:1,trail:100,opacity:0.25,fps:20,zIndex:2000000000,className:"spinner",top:"auto",left:"auto"},s=function r(b){if(!this.spin){return new r(b)}this.opts=v(b||{},r.defaults,t)};s.defaults={},v(s.prototype,{spin:function(Q){this.stop();var P=this,O=P.opts,N=P.el=w(B(0,{className:O.className}),{position:"relative",zIndex:O.zIndex}),M=O.radius+O.length+O.width,L,K;Q&&(Q.insertBefore(N,Q.firstChild||null),K=u(Q),L=u(N),w(N,{left:(O.left=="auto"?K.x-L.x+(Q.offsetWidth>>1):O.left+M)+"px",top:(O.top=="auto"?K.y-L.y+(Q.offsetHeight>>1):O.top+M)+"px"})),N.setAttribute("aria-role","progressbar"),P.lines(N,P.opts);if(!C){var J=0,I=O.fps,n=I/O.speed,l=(1-O.opacity)/(n*O.trail/100),g=n/O.lines;!function f(){J++;for(var b=O.lines;b;b--){var c=Math.max(1-(J+b*g)%n*l,O.opacity);P.opacity(N,O.lines-b,c,O)}P.timeout=P.el&&setTimeout(f,~~(1000/I))}()}return P},stop:function(){var b=this.el;return b&&(clearTimeout(this.timeout),b.parentNode&&b.parentNode.removeChild(b),this.el=F),this},lines:function(g,f){function h(b,c){return w(B(),{position:"absolute",width:f.length+f.width+"px",height:f.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*j+f.rotate)+"deg) translate("+f.radius+"px,0)",borderRadius:(f.width>>1)+"px"})}var j=0,i;for(;j<f.lines;j++){i=w(B(),{position:"absolute",top:1+~(f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:C&&y(f.opacity,f.trail,j,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&A(i,w(h("#000","0 0 4px #000"),{top:"2px"})),A(g,A(i,h(f.color,"0 0 1px rgba(0,0,0,.1)")))}return g},opacity:function(e,d,f){d<e.childNodes.length&&(e.childNodes[d].style.opacity=f)}}),!function(){function d(f,e){return B("<"+f+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',e)}var c=w(B("group"),{behavior:"url(#default#VML)"});!x(c,"transform")&&c.adj?(z.addRule(".spin-vml","behavior:url(#default#VML)"),s.prototype.lines=function(I,q){function n(){return w(d("group",{coordsize:o+" "+o,coordorigin:-p+" "+-p}),{width:o,height:o})}function a(f,j,i){A(l,A(w(n(),{rotation:360/q.lines*f+"deg",left:~~j}),A(w(d("roundrect",{arcsize:1}),{width:p,height:q.width,left:q.radius,top:-q.width>>1,filter:i}),d("fill",{color:q.color,opacity:q.opacity}),d("stroke",{opacity:0}))))}var p=q.length+q.width,o=2*p,m=-(q.width+q.length)*2+"px",l=w(n(),{position:"absolute",top:m,left:m}),h;if(q.shadow){for(h=1;h<=q.lines;h++){a(h,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)")}}for(h=1;h<=q.lines;h++){a(h)}return A(I,l)},s.prototype.opacity=function(g,f,j,i){var h=g.firstChild;i=i.shadow&&i.lines||0,h&&f+i<h.childNodes.length&&(h=h.childNodes[f+i],h=h&&h.firstChild,h=h&&h.firstChild,h&&(h.opacity=j))}):C=x(c,"animation")}(),H.Spinner=s})(window,document);
/*!
 * Main function
 * Initializations
 */
$(document).ready(function(){new Loading($("#loadingFrame"));var a=new SideMenu($("#menu"),$("#mainFrame"),$("#topbarID"));new MainApps(a,$("#applicationFrame"));new Wolfpacks(a,$("#applicationFrame"));new SearchApp("search",a,$("#applicationFrame"),$("#txtSearchBox"),$("#btnSearch"),$("#btnAdd"));testZone()});function testZone(){$("#btnLoad").click(function(){alert("Does nothing...")})};